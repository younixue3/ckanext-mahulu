{% extends 'page.html' %}
{% block title %}Home{% endblock %}

{% set groups = h.get_featured_groups(9999) %}
{% set top_organization = h.get_featured_organizations(5) %}
{% set stats = h.get_site_statistics() %}

{%- block content %}
<!-- Hero Section -->
<section class="relative w-full h-[28rem] flex items-center justify-center overflow-hidden">
  <img class="absolute inset-0 w-full h-full object-cover" src="/20230510_173816.jpg" alt="Mahakam Ulu landscape">
  <div class="absolute inset-0 bg-black/50"></div>

  <div class="relative z-10 max-w-6xl mx-auto px-4 flex items-center gap-8">
    <!-- Text & Search -->
    <div class="flex-1 text-white">
      <h1 class="text-4xl md:text-5xl font-bold leading-tight mb-4">
        Temukan Data Kabupaten Mahakam Ulu dengan Mudah
      </h1>
      <p class="text-lg mb-6 opacity-90">
        Ketik kata kunci dan tekan cari â€” data terbuka kini lebih dekat.
      </p>
      {% block search %}
        {% snippet 'home/snippets/search.html', search_facets=search_facets %}
      {% endblock %}
    </div>

    <!-- Decorative Image -->
    <div class="hidden md:flex flex-1 justify-center">
      <img class="h-64 object-contain drop-shadow-lg" src="/g2048.png" alt="Open data illustration">
    </div>
  </div>
</section>


<!-- About Section -->
<section class="relative bg-gradient-to-br from-indigo-50 to-sky-50 overflow-hidden">
  <div class="absolute inset-0 opacity-10">
    <svg viewBox="0 0 1000 1000" xmlns="http://www.w3.org/2000/svg" class="w-full h-full">
      <defs>
        <pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse">
          <path d="M 40 0 L 0 0 0 40" fill="none" stroke="indigo" stroke-width="1"/>
        </pattern>
      </defs>
      <rect width="100%" height="100%" fill="url(#grid)"/>
    </svg>
  </div>
  <div class="max-w-6xl mx-auto px-4 py-20 relative z-10">
    <div class="grid md:grid-cols-2 gap-12 items-center">
      <div>
        <h2 class="text-3xl md:text-4xl font-extrabold text-gray-900 mb-4">Tentang Portal Data Mahakam Ulu</h2>
        <p class="text-gray-700 mb-6 leading-relaxed">
          Portal ini menghadirkan data terbuka dari Kabupaten Mahakam Ulu secara transparan dan akuntabel. 
          Jelajahi dataset dari berbagai sektor untuk mendukung pengambilan keputusan, penelitian, dan inovasi masyarakat.
        </p>
        <a href="/about" 
           class="inline-flex items-center gap-2 px-5 py-3 rounded-full bg-indigo-600 text-white font-semibold hover:bg-indigo-700 transition-all duration-300 shadow-lg hover:shadow-indigo-500/40">
          Pelajari Selengkapnya
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
          </svg>
        </a>
      </div>
      <div class="relative">
        <div class="absolute -top-4 -left-4 w-72 h-72 bg-indigo-200 rounded-full opacity-30 blur-2xl"></div>
        <div class="absolute -bottom-4 -right-4 w-72 h-72 bg-sky-200 rounded-full opacity-30 blur-2xl"></div>
        <img src="/about-illus.png" alt="Open data illustration" class="relative z-10 w-full drop-shadow-xl">
      </div>
    </div>
  </div>
</section>

<!-- Topics -->
<section class="max-w-6xl mx-auto px-4 py-20">
  <div class="text-center mb-12">
    <h2 class="text-3xl md:text-4xl font-extrabold text-gray-900 mb-2">Telusuri Topik</h2>
    <p class="text-gray-600 max-w-2xl mx-auto">Pilih kategori yang sesuai untuk menemukan dataset yang Anda butuhkan.</p>
  </div>
  <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-6 gap-6">
    {% for item in groups %}
      <a href="{{ h.url_for(item.type ~ '.read', id=item.name) }}"
         class="group relative flex flex-col items-center p-5 rounded-2xl bg-white border border-gray-200 hover:border-indigo-400 hover:shadow-xl transition-all duration-300 overflow-hidden">
        <div class="absolute inset-0 bg-gradient-to-br from-indigo-50 to-sky-50 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
        <img class="h-16 w-16 object-contain mb-3 z-10 group-hover:scale-110 transition-transform duration-300"
             src="{{ item.image_display_url or '/images/placeholder-group.png' }}"
             alt="{{ item.title }}">
        <span class="text-sm text-gray-700 group-hover:text-indigo-600 z-10">{{ item.title }}</span>
      </a>
    {% endfor %}
  </div>
</section>

<!-- Stats & Orgs -->
<section class="max-w-6xl mx-auto px-4 pb-20 grid md:grid-cols-2 gap-8">
  <!-- Stats -->
  <div class="relative bg-white rounded-2xl border border-gray-200 p-8 shadow-lg hover:shadow-xl transition-shadow duration-300 overflow-hidden">
    <div class="absolute top-0 right-0 w-32 h-32 bg-indigo-100 rounded-full -translate-y-16 translate-x-16 opacity-30 blur-2xl"></div>
    <h3 class="text-xl font-bold text-gray-900 mb-6">Statistik Portal</h3>
    <div class="flex gap-8">
      <a href="{{ h.url_for('dataset.search') }}" class="flex-1 text-center group">
        <div class="text-4xl font-extrabold text-indigo-600 group-hover:text-indigo-700 transition">{{ h.SI_number_span(stats.dataset_count) }}</div>
        <div class="text-sm text-gray-600 mt-1">Dataset</div>
      </a>
      <a href="{{ h.url_for('organization.index') }}" class="flex-1 text-center group">
        <div class="text-4xl font-extrabold text-indigo-600 group-hover:text-indigo-700 transition">{{ h.SI_number_span(stats.organization_count) }}</div>
        <div class="text-sm text-gray-600 mt-1">Organisasi</div>
      </a>
    </div>
  </div>

  <!-- Top Organizations -->
  <div class="relative bg-white rounded-2xl border border-gray-200 p-8 shadow-lg hover:shadow-xl transition-shadow duration-300">
    <div class="absolute top-0 left-0 w-32 h-32 bg-sky-100 rounded-full -translate-y-16 -translate-x-16 opacity-30 blur-2xl"></div>
    <h3 class="text-xl font-bold text-gray-900 mb-6">Organisasi Populer</h3>
    <ul class="space-y-4">
      {% for item in top_organization %}
        <li>
          <a href="{{ h.url_for(item.type ~ '.read', id=item.name) }}"
             class="flex items-center justify-between text-sm p-3 rounded-lg hover:bg-gray-50 transition">
            <span class="text-gray-800 font-medium">{{ item.title }}</span>
            <span class="px-3 py-1 rounded-full bg-indigo-50 text-indigo-700 font-semibold">{{ item.packages|length }}</span>
          </a>
        </li>
      {% endfor %}
    </ul>
  </div>
</section>

<!-- Latest Datasets -->
<section class="max-w-6xl mx-auto px-4 pb-20">
  <div class="text-center mb-12">
    <h2 class="text-3xl md:text-4xl font-extrabold text-gray-900 mb-2">Dataset Terbaru</h2>
    <p class="text-gray-600 max-w-2xl mx-auto">Temukan dataset paling mutakhir dari berbagai organisasi.</p>
  </div>
  <div class="bg-white rounded-2xl border border-gray-200 shadow-lg md:flex">
    <!-- Facets -->
    <aside class="md:w-1/3 p-6 border-b md:border-b-0 md:border-r border-gray-200">
      <h3 class="text-base font-semibold text-gray-900 mb-4">Filter</h3>
      {% for facet in facet_titles %}
        {{ h.snippet('snippets/facet_list.html',
                      title=facet_titles[facet],
                      name=facet,
                      search_facets=search_facets) }}
      {% endfor %}
    </aside>
 
    <!-- List -->
    <div class="md:w-2/3 p-6">
      {% block form %}
        {% set facets = {
          'fields': fields_grouped,
          'search': search_facets,
          'titles': facet_titles,
          'translated_fields': translated_fields,
          'remove_field': remove_field
        } %}
        {% set sorting = [
          (_('Relevance'), 'score desc, metadata_modified desc'),
          (_('Name Ascending'), 'title_string asc'),
          (_('Name Descending'), 'title_string desc'),
          (_('Last Modified'), 'metadata_modified desc'),
          (_('Popular'), 'views_recent desc') if g.tracking_enabled else (false, false)
        ] %}
      {% endblock %}
      {{ h.snippet('snippets/package_list_rdev.html',
                   packages=h.mahulu_newset_dataset()) }}
    </div>
  </div>
</section>
{% endblock -%}