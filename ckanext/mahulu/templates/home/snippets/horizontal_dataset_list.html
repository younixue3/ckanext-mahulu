{% block package_list %}
{% if packages %}
<div class="bg-gray-50 border border-gray-400 rounded-2xl p-6">
  
  <!-- Search Input -->
  <div class="mb-6">
    <div class="relative">
      <input type="text" placeholder="Cari dataset..." 
             class="w-full rounded-xl border border-gray-300 px-5 py-3 pl-10 focus:ring-2 focus:ring-green-600 focus:outline-none text-gray-800"
             value="{{ c.q or '' }}">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-gray-400 absolute left-3 top-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-4.35-4.35m0 0A7.5 7.5 0 1110.5 3a7.5 7.5 0 016.15 13.65z"/>
      </svg>
    </div>
  </div>

  <!-- Horizontal Scroll Section -->
  <div id="dataset-scroll" 
       class="flex gap-4 overflow-x-auto scroll-smooth snap-x snap-mandatory pb-4 px-1">
    
    {% for package in packages %}
      {% set item = h.mahulu_showing_dataset(package) %}
      <a href="{{ h.url_for('dataset.read', id=item.name) }}"
         class="flex-none w-64 bg-white rounded-2xl border border-gray-200 shadow-sm hover:shadow-md transition-all duration-300 snap-start p-5">
        <span class="inline-block text-xs font-semibold bg-green-700 text-white px-3 py-1 rounded-full mb-3">Dataset</span>
        <h3 class="text-base font-semibold text-gray-900 mb-2 line-clamp-2">
          {{ item.title or item.name }}
        </h3>
        <p class="text-sm text-gray-600 line-clamp-3">{{ item.notes | truncate(100) }}</p>
      </a>
    {% endfor %}

    <!-- Special Card -->
    <div class="flex-none w-64 bg-green-700 text-white rounded-2xl p-5 flex flex-col justify-center snap-start shadow-md">
      <h3 class="text-lg font-semibold mb-2">Terbaru di Open Data</h3>
      <p class="text-sm opacity-90 leading-relaxed">
        Temukan berbagai Dataset, mapset, dan konten yang paling terbaru disini
      </p>
    </div>
  </div>

  <!-- Pagination / Counter -->
  <div class="flex items-center justify-between mt-4 text-sm text-gray-600 px-1">
    <div class="flex items-center gap-2">
      <div class="w-2.5 h-2.5 bg-green-600 rounded-full"></div>
      <div class="flex gap-1 items-center text-gray-700 font-medium">
        <span id="range-display">1–{% if packages|length < 4 %}{{ packages|length }}{% else %}4{% endif %}</span>
        <span>dari {{ packages|length }}</span>
      </div>
    </div>
    <div class="flex-grow h-1 mx-4 bg-gray-200 rounded-full overflow-hidden">
      <div id="progress-bar" class="h-full bg-green-600 transition-all duration-500" style="width: 40%;"></div>
    </div>
  </div>
</div>

<!-- Optional Script for Scroll Progress -->
<script>
document.addEventListener('DOMContentLoaded', () => {
  const scroll = document.getElementById('dataset-scroll');
  const progressBar = document.getElementById('progress-bar');
  const rangeDisplay = document.getElementById('range-display');
  const total = {{ packages|length }};
  const perView = 4;
  scroll.addEventListener('scroll', () => {
    const maxScroll = scroll.scrollWidth - scroll.clientWidth;
    const progress = scroll.scrollLeft / maxScroll;
    progressBar.style.width = `${Math.min(100, progress * 100)}%`;
    const start = Math.round(progress * (total - perView)) + 1;
    const end = Math.min(start + perView - 1, total);
    rangeDisplay.textContent = `${start}–${end}`;
  });
});
</script>
{% endif %}
{% endblock %}
